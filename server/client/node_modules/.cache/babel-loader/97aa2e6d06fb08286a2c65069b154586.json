{"ast":null,"code":"import _slicedToArray from\"E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useContext}from'react';import{UserContext}from'../../App';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=function Home(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var _useContext=useContext(UserContext),state=_useContext.state,dispatch=_useContext.dispatch;useEffect(function(){fetch('/allpost',{headers:{\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);setData(result.posts);});},[]);var likePost=function likePost(id){fetch('/like',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){//   console.log(result)\nvar newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var unlikePost=function unlikePost(id){fetch('/unlike',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:id})}).then(function(res){return res.json();}).then(function(result){//   console.log(result)\nvar newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var makeComment=function makeComment(text,postId){fetch('/comment',{method:\"put\",headers:{\"Content-Type\":\"application/json\",\"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")},body:JSON.stringify({postId:postId,text:text})}).then(function(res){return res.json();}).then(function(result){console.log(result);var newData=data.map(function(item){if(item._id==result._id){return result;}else{return item;}});setData(newData);}).catch(function(err){console.log(err);});};var deletePost=function deletePost(postid){fetch(\"/deletepost/\".concat(postid),{method:\"delete\",headers:{Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")}}).then(function(res){return res.json();}).then(function(result){console.log(result);var newData=data.filter(function(item){return item._id!==result._id;});setData(newData);});};return/*#__PURE__*/_jsx(\"div\",{className:\"home\",children:data.map(function(item){return/*#__PURE__*/_jsxs(\"div\",{className:\"card home-card\",children:[/*#__PURE__*/_jsxs(\"h5\",{style:{padding:\"5px\"},children:[/*#__PURE__*/_jsx(Link,{to:item.postedBy._id!==state._id?\"/profile/\"+item.postedBy._id:\"/profile\",children:item.postedBy.name}),\" \",item.postedBy._id==state._id&&/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",style:{float:\"right\"},onClick:function onClick(){return deletePost(item._id);},children:\"delete\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"card-image\",children:/*#__PURE__*/_jsx(\"img\",{src:item.photo})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",style:{color:\"red\"},children:\"favorite\"}),item.likes.includes(state._id)?/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",onClick:function onClick(){unlikePost(item._id);},children:\"thumb_down\"}):/*#__PURE__*/_jsx(\"i\",{className:\"material-icons\",onClick:function onClick(){likePost(item._id);},children:\"thumb_up\"}),/*#__PURE__*/_jsxs(\"h6\",{children:[item.likes.length,\" likes\"]}),/*#__PURE__*/_jsx(\"h6\",{children:item.title}),/*#__PURE__*/_jsx(\"p\",{children:item.body}),item.comments.map(function(record){return/*#__PURE__*/_jsxs(\"h6\",{children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:\"500\"},children:record.postedBy.name}),\" \",record.text]},record._id);}),/*#__PURE__*/_jsx(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();makeComment(e.target[0].value,item._id);},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"add a comment\"})})]})]},item._id);})});};export default Home;","map":{"version":3,"sources":["E:/HDD/AKSHAT/STUDY/MERN INSTA/server/client/src/components/screens/Home.js"],"names":["React","useState","useEffect","useContext","UserContext","Link","Home","data","setData","state","dispatch","fetch","headers","localStorage","getItem","then","res","json","result","console","log","posts","likePost","id","method","body","JSON","stringify","postId","newData","map","item","_id","catch","err","unlikePost","makeComment","text","deletePost","postid","Authorization","filter","padding","postedBy","name","float","photo","color","likes","includes","length","title","comments","record","fontWeight","e","preventDefault","target","value"],"mappings":"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","sourcesContent":["import React,{useState,useEffect,useContext} from 'react'\r\nimport {UserContext} from '../../App'\r\nimport {Link} from 'react-router-dom'\r\n\r\n\r\nconst Home  = ()=>{\r\n    const [data,setData] = useState([])\r\n    const {state,dispatch} = useContext(UserContext)\r\n    useEffect(()=>{\r\n       fetch('/allpost',{\r\n           headers:{\r\n               \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n           }\r\n       }).then(res=>res.json())\r\n       .then(result=>{\r\n           console.log(result)\r\n           setData(result.posts)\r\n       })\r\n    },[])\r\n\r\n    const likePost = (id)=>{\r\n          fetch('/like',{\r\n              method:\"put\",\r\n              headers:{\r\n                  \"Content-Type\":\"application/json\",\r\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n              },\r\n              body:JSON.stringify({\r\n                  postId:id\r\n              })\r\n          }).then(res=>res.json())\r\n          .then(result=>{\r\n                   //   console.log(result)\r\n            const newData = data.map(item=>{\r\n                if(item._id==result._id){\r\n                    return result\r\n                }else{\r\n                    return item\r\n                }\r\n            })\r\n            setData(newData)\r\n          }).catch(err=>{\r\n              console.log(err)\r\n          })\r\n    }\r\n    const unlikePost = (id)=>{\r\n          fetch('/unlike',{\r\n              method:\"put\",\r\n              headers:{\r\n                  \"Content-Type\":\"application/json\",\r\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n              },\r\n              body:JSON.stringify({\r\n                  postId:id\r\n              })\r\n          }).then(res=>res.json())\r\n          .then(result=>{\r\n            //   console.log(result)\r\n            const newData = data.map(item=>{\r\n                if(item._id==result._id){\r\n                    return result\r\n                }else{\r\n                    return item\r\n                }\r\n            })\r\n            setData(newData)\r\n          }).catch(err=>{\r\n            console.log(err)\r\n        })\r\n    }\r\n\r\n    const makeComment = (text,postId)=>{\r\n          fetch('/comment',{\r\n              method:\"put\",\r\n              headers:{\r\n                  \"Content-Type\":\"application/json\",\r\n                  \"Authorization\":\"Bearer \"+localStorage.getItem(\"jwt\")\r\n              },\r\n              body:JSON.stringify({\r\n                  postId,\r\n                  text\r\n              })\r\n          }).then(res=>res.json())\r\n          .then(result=>{\r\n              console.log(result)\r\n              const newData = data.map(item=>{\r\n                if(item._id==result._id){\r\n                    return result\r\n                }else{\r\n                    return item\r\n                }\r\n             })\r\n            setData(newData)\r\n          }).catch(err=>{\r\n              console.log(err)\r\n          })\r\n    }\r\n\r\n    const deletePost = (postid)=>{\r\n        fetch(`/deletepost/${postid}`,{\r\n            method:\"delete\",\r\n            headers:{\r\n                Authorization:\"Bearer \"+localStorage.getItem(\"jwt\")\r\n            }\r\n        }).then(res=>res.json())\r\n        .then(result=>{\r\n            console.log(result)\r\n            const newData = data.filter(item=>{\r\n                return item._id !== result._id\r\n            })\r\n            setData(newData)\r\n        })\r\n    }\r\n   return (\r\n       <div className=\"home\">\r\n           {\r\n               data.map(item=>{\r\n                   return(\r\n                       <div className=\"card home-card\" key={item._id}>\r\n                            <h5 style={{padding:\"5px\"}}><Link to={item.postedBy._id !== state._id?\"/profile/\"+item.postedBy._id :\"/profile\"  }>{item.postedBy.name}</Link> {item.postedBy._id == state._id \r\n                            && <i className=\"material-icons\" style={{\r\n                                float:\"right\"\r\n                            }} \r\n                            onClick={()=>deletePost(item._id)}\r\n                            >delete</i>\r\n\r\n                            }</h5>\r\n                            <div className=\"card-image\">\r\n                                <img src={item.photo}/>\r\n                            </div>\r\n                            <div className=\"card-content\">\r\n                            <i className=\"material-icons\" style={{color:\"red\"}}>favorite</i>\r\n                            {item.likes.includes(state._id)\r\n                            ? \r\n                             <i className=\"material-icons\"\r\n                                    onClick={()=>{unlikePost(item._id)}}\r\n                              >thumb_down</i>\r\n                            : \r\n                            <i className=\"material-icons\"\r\n                            onClick={()=>{likePost(item._id)}}\r\n                            >thumb_up</i>\r\n                            }\r\n                            \r\n                           \r\n                                <h6>{item.likes.length} likes</h6>\r\n                                <h6>{item.title}</h6>\r\n                                <p>{item.body}</p>\r\n                                {\r\n                                    item.comments.map(record=>{\r\n                                        return(\r\n                                        <h6 key={record._id}><span style={{fontWeight:\"500\"}}>{record.postedBy.name}</span> {record.text}</h6>\r\n                                        )\r\n                                    })\r\n                                }\r\n                                <form onSubmit={(e)=>{\r\n                                    e.preventDefault()\r\n                                    makeComment(e.target[0].value,item._id)\r\n                                }}>\r\n                                  <input type=\"text\" placeholder=\"add a comment\" />  \r\n                                </form>\r\n                                \r\n                            </div>\r\n                        </div> \r\n                   )\r\n               })\r\n           }\r\n          \r\n          \r\n       </div>\r\n   )\r\n}\r\n\r\n\r\nexport default Home"]},"metadata":{},"sourceType":"module"}